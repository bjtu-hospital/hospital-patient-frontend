# æ‚£è€…ç«¯å¾…å®ç°æ¥å£æ–‡æ¡£ - å°±è¯Šäººç®¡ç†å’Œé¢„çº¦åŠŸèƒ½

## ğŸ“‹ æ¥å£å®ç°çŠ¶æ€æ€»è§ˆï¼ˆåŸºäº Swagger æ–‡æ¡£ï¼‰

### âœ… å·²å®ç°çš„æ¥å£ï¼ˆ3ä¸ªï¼‰
- `POST /patient/appointments` - åˆ›å»ºé¢„çº¦ï¼ˆâš ï¸ å­˜åœ¨Tokenè®¤è¯é—®é¢˜ï¼‰
- `GET /patient/appointments` - è·å–é¢„çº¦åˆ—è¡¨
- `PUT /patient/appointments/{appointmentId}/cancel` - å–æ¶ˆé¢„çº¦

### âŒ å¾…å®ç°çš„æ¥å£ï¼ˆ6ä¸ªï¼‰

**å°±è¯Šäººç®¡ç†ï¼ˆ5ä¸ªï¼‰ï¼š**
- `GET /patient/patients` - è·å–å°±è¯Šäººåˆ—è¡¨
- `POST /patient/patients` - æ·»åŠ å°±è¯Šäºº
- `PUT /patient/patients/{patient_id}` - æ›´æ–°å°±è¯Šäºº
- `DELETE /patient/patients/{patient_id}` - åˆ é™¤å°±è¯Šäºº
- `PUT /patient/patients/{patient_id}/set-default` - è®¾ç½®é»˜è®¤å°±è¯Šäºº

**é¢„çº¦ç®¡ç†ï¼ˆ1ä¸ªï¼‰ï¼š**
- `GET /patient/appointments/{appointmentId}` - é¢„çº¦è¯¦æƒ…



## ä¸€ã€å°±è¯Šäººç®¡ç†æ¥å£

### 1.1 è·å–å°±è¯Šäººåˆ—è¡¨

**æ¥å£è·¯å¾„ï¼š** `GET /patient/patients`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {token}
```

**è¯·æ±‚å‚æ•°ï¼š** æ— 

**è¿”å›æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": [
    {
      "id": "patient_001",
      "name": "å¼ ä¸‰",
      "id_card": "110101199001011234",
      "phone": "13800138000",
      "relation": "æœ¬äºº",
      "is_default": true,
      "created_at": "2025-11-30T10:00:00"
    },
    {
      "id": "patient_002",
      "name": "æå››",
      "id_card": "110101199501015678",
      "phone": "13900139000",
      "relation": "çˆ¶æ¯",
      "is_default": false,
      "created_at": "2025-11-30T11:00:00"
    }
  ]
}
```

**âš ï¸ é‡è¦è¯´æ˜ï¼š**
- è¿”å›çš„ `message` å­—æ®µ**ç›´æ¥æ˜¯æ•°ç»„**ï¼Œä¸æ˜¯ `{ patients: [...] }` å¯¹è±¡
- å‰ç«¯ä¼šè‡ªåŠ¨å°†å­—æ®µè½¬æ¢ä¸ºé©¼å³°å‘½åï¼š`id_card` â†’ `idCard`ã€`is_default` â†’ `isDefault`

**å­—æ®µè¯´æ˜ï¼š**
- `id`: å°±è¯ŠäººIDï¼ˆå¿…éœ€ï¼ŒStringç±»å‹ï¼‰
- `name`: å§“åï¼ˆå¿…éœ€ï¼‰
- `id_card`: èº«ä»½è¯å·ï¼ˆå¿…éœ€ï¼‰
- `phone`: æ‰‹æœºå·ï¼ˆå¿…éœ€ï¼‰
- `relation`: ä¸æ‚£è€…å…³ç³»ï¼ˆæœ¬äºº/çˆ¶æ¯/é…å¶/å­å¥³/å…¶ä»–ï¼‰
- `is_default`: æ˜¯å¦ä¸ºé»˜è®¤å°±è¯Šäººï¼ˆBooleanï¼‰
- `created_at`: åˆ›å»ºæ—¶é—´ï¼ˆISOæ ¼å¼å­—ç¬¦ä¸²ï¼‰

---

### 1.2 æ·»åŠ å°±è¯Šäºº

**æ¥å£è·¯å¾„ï¼š** `POST /patient/patients`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "name": "å¼ ä¸‰",
  "id_card": "110101199001011234",
  "phone": "13800138000",
  "relation": "æœ¬äºº",
  "is_default": false
}
```

**è¯·æ±‚å‚æ•°è¯´æ˜ï¼š**
- `name` (å¿…éœ€): å§“å
- `id_card` (å¿…éœ€): èº«ä»½è¯å·ï¼ˆ18ä½ï¼‰
- `phone` (å¿…éœ€): æ‰‹æœºå·ï¼ˆ11ä½ï¼‰
- `relation` (å¿…éœ€): å…³ç³»ï¼ˆæœ¬äºº/çˆ¶æ¯/é…å¶/å­å¥³/å…¶ä»–ï¼‰
- `is_default` (å¯é€‰): æ˜¯å¦è®¾ä¸ºé»˜è®¤å°±è¯Šäººï¼Œé»˜è®¤ false

**è¿”å›æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": {
    "id": "patient_003"
  }
}
```

**âš ï¸ æ³¨æ„ï¼š**
- è¿”å›çš„æ˜¯ `id` å­—æ®µï¼ˆStringç±»å‹ï¼‰ï¼Œå‰ç«¯ç”¨äºæ ‡è¯†æ–°åˆ›å»ºçš„å°±è¯Šäºº
- å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå°±è¯Šäººï¼Œå»ºè®®åç«¯è‡ªåŠ¨è®¾ç½®ä¸ºé»˜è®¤

---

### 1.3 æ›´æ–°å°±è¯Šäºº

**æ¥å£è·¯å¾„ï¼š** `PUT /patient/patients/{patient_id}`

**URLå‚æ•°ï¼š**
- `patient_id`: å°±è¯ŠäººIDï¼ˆStringç±»å‹ï¼Œå¦‚ "patient_001"ï¼‰

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {token}
Content-Type: application/json
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "name": "å¼ ä¸‰",
**è¿”å›æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "æ›´æ–°æˆåŠŸ"
}
```

**âš ï¸ æ³¨æ„ï¼š**
- æ”¯æŒé€šè¿‡æ­¤æ¥å£è®¾ç½®é»˜è®¤å°±è¯Šäººï¼ˆä¼ å…¥ `is_default: true`ï¼‰
- è®¾ç½®æ–°çš„é»˜è®¤å°±è¯Šäººæ—¶ï¼Œåç«¯éœ€è‡ªåŠ¨å–æ¶ˆå…¶ä»–å°±è¯Šäººçš„é»˜è®¤çŠ¶æ€

---

### 1.4 åˆ é™¤å°±è¯Šäºº "æœ¬äºº",
  "is_default": true
}
```

**è¯·æ±‚å‚æ•°è¯´æ˜ï¼š**
- æ‰€æœ‰å­—æ®µéƒ½æ˜¯å¯é€‰çš„ï¼Œåªä¼ éœ€è¦æ›´æ–°çš„å­—æ®µ
- `is_default`: å¦‚æœè®¾ä¸º trueï¼Œéœ€è¦å°†å…¶ä»–å°±è¯Šäººçš„ is_default è®¾ä¸º false

**è¿”å›æ ¼å¼ï¼š**
```json
### 1.4 åˆ é™¤å°±è¯Šäºº

**æ¥å£è·¯å¾„ï¼š** `DELETE /patient/patients/{patient_id}`

**URLå‚æ•°ï¼š**
- `patient_id`: å°±è¯ŠäººIDï¼ˆStringç±»å‹ï¼‰

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {token}
```

**è¿”å›æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "åˆ é™¤æˆåŠŸ"
}
```

**ä¸šåŠ¡è§„åˆ™ï¼š**
- é»˜è®¤å°±è¯Šäººï¼ˆ`is_default: true`ï¼‰ä¸å…è®¸åˆ é™¤
- å‰ç«¯ä¼šåœ¨è°ƒç”¨å‰åšæ ¡éªŒï¼Œåç«¯ä¹Ÿåº”åšç›¸åŒæ ¡éªŒ
- å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å›ï¼š
  ```json
  {
    "code": 400,
    "message": "é»˜è®¤å°±è¯Šäººä¸èƒ½åˆ é™¤"
  }
  ```

---
**è¿”å›æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "è®¾ç½®æˆåŠŸ"
}
```

**ä¸šåŠ¡è§„åˆ™ï¼š**
- è®¾ç½®æ–°çš„é»˜è®¤å°±è¯Šäººæ—¶ï¼Œè‡ªåŠ¨å–æ¶ˆå…¶ä»–å°±è¯Šäººçš„é»˜è®¤çŠ¶æ€

---

## äºŒã€é¢„çº¦è¯¦æƒ…æ¥å£

### 2.1 é¢„çº¦è¯¦æƒ…
```
Authorization: Bearer {token}
```

**è¿”å›æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": "è®¾ç½®æˆåŠŸ"
}
```
### 2.1 é¢„çº¦è¯¦æƒ…

**æ¥å£è·¯å¾„ï¼š** `GET /patient/appointments/{appointmentId}`

**URLå‚æ•°ï¼š**
- `appointmentId`: é¢„çº¦IDï¼ˆString/Numberç±»å‹ï¼‰

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {token}
```

**è¿”å›æ ¼å¼ï¼š**
```json
{
  "code": 0,
  "message": {
    "id": "appointment_001",
    "order_no": "202512011234567890",
    "hospital_id": "hospital_001",
    "hospital_name": "åŒ—äº¬äº¤é€šå¤§å­¦æ ¡åŒ»é™¢ï¼ˆæœ¬éƒ¨ï¼‰",
    "hospital_address": "åŒ—äº¬å¸‚æµ·æ·€åŒºä¸Šå›­æ‘3å·",
    "department_id": "dept_005",
    "department_name": "å¿ƒå†…ç§‘",
    "doctor_id": "doctor_013",
    "doctor_name": "å¼ åŒ»ç”Ÿ",
    "doctor_title": "ä¸»æ²»åŒ»å¸ˆ",
    "doctor_avatar": "/static/logo.png",
    "patient_id": "patient_001",
    "patient_name": "å¼ ä¸‰",
    "patient_phone": "13800138000",
    "schedule_id": "schedule_12345",
    "appointment_date": "2025-12-03",
    "appointment_time": "ä¸Šåˆ 08:00-08:30",
    "queue_number": "15",
    "price": 50.0,
    "symptoms": "å¤´ç—›å‘çƒ­",
    "status": "pending",
    "payment_status": "paid",
    "can_cancel": true,
    "can_reschedule": true,
    "created_at": "2025-12-01T10:30:00",
    "updated_at": "2025-12-01T10:30:00"
  }
}
```

**âš ï¸ é‡è¦å­—æ®µè¯´æ˜ï¼š**
**ä¸šåŠ¡è§„åˆ™ï¼š**
- é¢„çº¦æ—¶é—´24å°æ—¶å†…ä¸å¯å–æ¶ˆã€ä¸å¯æ”¹çº¦
- å·²å®Œæˆ/å·²å–æ¶ˆçš„é¢„çº¦ä¸å¯æ“ä½œ "symptoms": "å¤´ç—›å‘çƒ­",
    "status": "pending",
    "paymentStatus": "paid",
    "canCancel": true,
    "canReschedule": true,
    "createdAt": "2025-11-30T10:30:00"
  }
}
```

---

## ä¸‰ã€é”™è¯¯ç è¯´æ˜

| é”™è¯¯ç  | è¯´æ˜ | å¤„ç†å»ºè®® |
|-------|------|---------|
| 0 | æˆåŠŸ | - |
| 98 | HTTPå¼‚å¸¸ï¼ˆ404ç­‰ï¼‰ | æ£€æŸ¥æ¥å£è·¯å¾„æ˜¯å¦æ­£ç¡® |
| 105 | Tokenæ— æ•ˆæˆ–å·²å¤±æ•ˆ | æ¸…é™¤æœ¬åœ°tokenï¼Œè·³è½¬ç™»å½•é¡µ |
| 400 | å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼ |
| 403 | æ— æƒè®¿é—® | æ£€æŸ¥ç”¨æˆ·æƒé™ |
| 500 | æœåŠ¡å™¨é”™è¯¯ | è”ç³»æŠ€æœ¯æ”¯æŒ |

---

## å››ã€æ³¨æ„äº‹é¡¹

å‰ç«¯ä¼šè‡ªåŠ¨å°†åç«¯è¿”å›çš„ä¸‹åˆ’çº¿å‘½åè½¬æ¢ä¸ºé©¼å³°å‘½åï¼š
- `patient_id` â†’ `id`
- `id_card` â†’ `idCard`
- `is_default` â†’ `isDefault`
- `created_at` â†’ `createdAt`

åç«¯è¿”å›å­—æ®µå»ºè®®ä½¿ç”¨ä¸‹åˆ’çº¿å‘½åï¼ˆsnake_caseï¼‰ï¼Œå‰ç«¯ä¼šè‡ªåŠ¨å¤„ç†ã€‚
